;; A quine in Lemma, demonstrating the Lua integration

;; A leading . is syntactic sugar for calling a method in a table
;; A leading : is sugar for a string not containing spaces or delimeters


;; Apply func to each line in file
(defn do-lines [file func]
  (def line (.read file))
  (if line
      (do
        (func line)
        (do-lines file func))
      nil))


(def quine (lua/io.open (lua/arg 1) :r))
(if quine
  (do
    (do-lines quine print)
    (.close quine)))
